--- app.py.orig
+++ app.py.updated
@@ -640,7 +640,7 @@
 
     for sem_id in sorted(timetables_by_semester.keys()):
         classes_for_sem = timetables_by_semester[sem_id]
-        sem_name = all_data['semesters_by_id'][sem_id].semester_number
+        sem_name = all_data['semesters_by_id'].get(sem_id).semester_number
         st.markdown(f"**Semester {sem_name} Timetable**")
 
         timetable_df = pd.DataFrame('', index=days, columns=periods_cols)
@@ -837,7 +837,7 @@
     
     st.markdown("---")
     st.subheader("Delete All My Data")
-    if st.button("Initiate Deletion of All My Data", type="danger", key="init_delete_all_data"):
+    if st.button("Initiate Deletion of All My Data", type="primary", key="init_delete_all_data"):
         st.session_state["confirm_delete_all_user_data"] = True
     
     if st.session_state.get("confirm_delete_all_user_data", False):

--- database.py.orig
+++ database.py.updated
@@ -13,6 +13,7 @@
 def get_db_connection():
     conn = sqlite3.connect(DATABASE_NAME)
     conn.row_factory = sqlite3.Row
+    conn.execute(\"PRAGMA foreign_keys = ON\")
     return conn
 
 def init_db():
@@ -254,9 +255,7 @@
     cursor = conn.cursor()
     cursor.execute("""
         SELECT f.id, f.name, f.emp_id, d.name as department_name, f.department_id
-        FROM faculty f
-        JOIN departments d ON f.department_id = d.id
-        WHERE f.user_id = ? AND d.user_id = ?
+        FROM faculty f LEFT JOIN departments d ON f.department_id = d.id WHERE f.user_id = ?
     """, (user_id, user_id))
     faculty = cursor.fetchall()
     conn.close()

